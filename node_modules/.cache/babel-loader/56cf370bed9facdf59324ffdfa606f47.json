{"ast":null,"code":"var _jsxFileName = \"/home/miltonejones/projects/react-sploosh-amplify/src/components/VideoCollection/VideoCollection.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport React from 'react';\nimport useComponentState from '../../hooks/useComponentState';\nimport { getVideos, getVideo, findVideos } from '../../connector/DbConnector';\nimport { VideoCard, ModelModal, useModelModal, Flex, StyledPagination } from '../';\nimport { TextField, Box, Button } from '@mui/material';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function VideoCollection(props) {\n  _s();\n\n  const {\n    setBusy,\n    response,\n    pageNum,\n    handleChange,\n    modelModalState,\n    showDialog,\n    busy\n  } = useVideoCollection(props);\n  const {\n    count,\n    records\n  } = response;\n  if (!records) return 'Loading...';\n  const totalPages = Math.ceil(count / 30);\n  return /*#__PURE__*/_jsxDEV(Box, {\n    className: \"\",\n    children: [/*#__PURE__*/_jsxDEV(Box, {\n      className: \"head\",\n      children: /*#__PURE__*/_jsxDEV(Flex, {\n        children: [/*#__PURE__*/_jsxDEV(StyledPagination, {\n          totalPages: totalPages,\n          page: pageNum,\n          handleChange: handleChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 23,\n          columnNumber: 11\n        }, this), !!busy && /*#__PURE__*/_jsxDEV(\"em\", {\n          children: \"loading...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 28,\n          columnNumber: 22\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 22,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 21,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      className: \"App\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"ThumbnailGrid\",\n        children: records === null || records === void 0 ? void 0 : records.map(video => /*#__PURE__*/_jsxDEV(VideoCard, {\n          video: video,\n          getModel: q => {\n            showDialog(q);\n          }\n        }, video.ID, false, {\n          fileName: _jsxFileName,\n          lineNumber: 34,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 32,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 31,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      className: \"head\",\n      children: /*#__PURE__*/_jsxDEV(Flex, {\n        children: /*#__PURE__*/_jsxDEV(StyledPagination, {\n          totalPages: totalPages,\n          page: pageNum,\n          handleChange: handleChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 46,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 45,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 44,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ModelModal, { ...modelModalState\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 20,\n    columnNumber: 5\n  }, this);\n}\n\n_s(VideoCollection, \"K+Fwq3JqMSZv1kAjVGuB5iNjVr8=\", false, function () {\n  return [useVideoCollection];\n});\n\n_c = VideoCollection;\n\nfunction useVideoCollection(_ref) {\n  _s2();\n\n  let {\n    collectionType,\n    searchParam,\n    pageNum,\n    onChange,\n    setBusy\n  } = _ref;\n  const {\n    state,\n    setState\n  } = useComponentState({\n    page: 1,\n    type: collectionType,\n    response: {}\n  });\n  const {\n    modelModalState,\n    showDialog\n  } = useModelModal();\n  const {\n    page,\n    response,\n    busy,\n    type\n  } = state;\n\n  const handleChange = (event, value) => {\n    onChange && onChange(value);\n  };\n\n  const loadVideos = React.useCallback(async p => {\n    const items = await getVideos(p);\n    console.log({\n      items\n    });\n    setState('response', items);\n    setState('page', p);\n  }, [page]);\n  const searchVideos = React.useCallback(async (str, p) => {\n    const items = await findVideos(str, p);\n    console.log({\n      items\n    });\n    setState('response', items);\n    setState('page', p);\n  }, [page]);\n  const load = React.useCallback(async (p, t) => {\n    setState('busy', !0);\n    setBusy(!0);\n\n    switch (collectionType) {\n      case 'search':\n        await searchVideos(searchParam, p);\n        break;\n\n      default:\n        await loadVideos(p);\n    }\n\n    setState('type', t);\n    setState('busy', !1);\n    setBusy(!1);\n  }, [collectionType]);\n  React.useEffect(() => {\n    const renew = pageNum !== page || collectionType !== type;\n    console.log([pageNum, page, renew.toString()]);\n    (!!renew || !response.records) && load(pageNum, collectionType);\n  }, [response, pageNum, page, collectionType, type]); // const { count, records } = response;\n  // if (!records) return 'Loading...';\n  // const totalPages = Math.ceil(count / 30);\n\n  return {\n    response,\n    searchParam,\n    pageNum,\n    handleChange,\n    modelModalState,\n    showDialog,\n    busy,\n    setBusy\n  };\n}\n\n_s2(useVideoCollection, \"t/jbVDWJyZ7uUlkDgF5dGC82H5c=\", false, function () {\n  return [useComponentState, useModelModal];\n});\n\nvar _c;\n\n$RefreshReg$(_c, \"VideoCollection\");","map":{"version":3,"sources":["/home/miltonejones/projects/react-sploosh-amplify/src/components/VideoCollection/VideoCollection.js"],"names":["React","useComponentState","getVideos","getVideo","findVideos","VideoCard","ModelModal","useModelModal","Flex","StyledPagination","TextField","Box","Button","VideoCollection","props","setBusy","response","pageNum","handleChange","modelModalState","showDialog","busy","useVideoCollection","count","records","totalPages","Math","ceil","map","video","q","ID","collectionType","searchParam","onChange","state","setState","page","type","event","value","loadVideos","useCallback","p","items","console","log","searchVideos","str","load","t","useEffect","renew","toString"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport useComponentState from '../../hooks/useComponentState';\r\nimport { getVideos, getVideo, findVideos } from '../../connector/DbConnector';\r\nimport {\r\n  VideoCard,\r\n  ModelModal,\r\n  useModelModal,\r\n  Flex,\r\n  StyledPagination,\r\n} from '../';\r\nimport { TextField, Box, Button } from '@mui/material';\r\n\r\nexport default function VideoCollection(props) {\r\n  const { setBusy, response, pageNum, handleChange, modelModalState, showDialog, busy } =\r\n    useVideoCollection(props);\r\n  const { count, records } = response;\r\n  if (!records) return 'Loading...';\r\n  const totalPages = Math.ceil(count / 30);\r\n  return (\r\n    <Box className=\"\">\r\n      <Box className=\"head\">\r\n        <Flex>\r\n          <StyledPagination\r\n            totalPages={totalPages}\r\n            page={pageNum}\r\n            handleChange={handleChange}\r\n          />\r\n          {!!busy && <em>loading...</em>}\r\n        </Flex>\r\n      </Box>\r\n      <Box className=\"App\">\r\n        <div className=\"ThumbnailGrid\">\r\n          {records?.map((video) => (\r\n            <VideoCard\r\n              key={video.ID}\r\n              video={video}\r\n              getModel={(q) => {\r\n                showDialog(q);\r\n              }}\r\n            />\r\n          ))}\r\n        </div>\r\n      </Box>\r\n      <Box className=\"head\">\r\n        <Flex>\r\n          <StyledPagination\r\n            totalPages={totalPages}\r\n            page={pageNum}\r\n            handleChange={handleChange}\r\n          />\r\n        </Flex>\r\n      </Box>\r\n      <ModelModal {...modelModalState} />\r\n    </Box>\r\n  );\r\n}\r\n\r\nfunction useVideoCollection({\r\n  collectionType,\r\n  searchParam,\r\n  pageNum,\r\n  onChange,\r\n  setBusy\r\n}) {\r\n  const { state, setState } = useComponentState({\r\n    page: 1,\r\n    type: collectionType,\r\n    response: {},\r\n  });\r\n  const { modelModalState, showDialog } = useModelModal();\r\n  const { page, response, busy, type } = state;\r\n\r\n  const handleChange = (event, value) => {\r\n    onChange && onChange(value);\r\n  };\r\n  const loadVideos = React.useCallback(\r\n    async (p) => {\r\n      const items = await getVideos(p);\r\n      console.log({ items });\r\n      setState('response', items);\r\n      setState('page', p);\r\n    },\r\n    [page]\r\n  );\r\n\r\n  const searchVideos = React.useCallback(\r\n    async (str, p) => {\r\n      const items = await findVideos(str, p);\r\n      console.log({ items });\r\n      setState('response', items);\r\n      setState('page', p);\r\n    },\r\n    [page]\r\n  );\r\n\r\n  const load = React.useCallback(\r\n    async (p, t) => {\r\n      setState('busy', !0);\r\n      setBusy(!0);\r\n      switch (collectionType) {\r\n        case 'search':\r\n          await searchVideos(searchParam, p);\r\n          break;\r\n        default:\r\n          await loadVideos(p);\r\n      }\r\n      setState('type', t);\r\n      setState('busy', !1);\r\n      setBusy(!1);\r\n    },\r\n    [collectionType]\r\n  );\r\n\r\n  React.useEffect(() => {\r\n    const renew = pageNum !== page || collectionType !== type;\r\n    console.log([pageNum, page, renew.toString()]);\r\n    (!!renew || !response.records) && load(pageNum, collectionType);\r\n  }, [response, pageNum, page, collectionType, type]);\r\n\r\n  // const { count, records } = response;\r\n  // if (!records) return 'Loading...';\r\n  // const totalPages = Math.ceil(count / 30);\r\n  return {\r\n    response,\r\n    searchParam,\r\n    pageNum,\r\n    handleChange,\r\n    modelModalState,\r\n    showDialog,\r\n    busy,\r\n    setBusy\r\n  };\r\n}\r\n"]},"metadata":{},"sourceType":"module"}